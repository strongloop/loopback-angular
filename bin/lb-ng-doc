#!/usr/bin/env node

var path = require('path');
var docular = require('docular');

if (process.argv.length < 3) {
  console.error('Usage:');
  console.error('    lb-ng-doc client/js/lb-services.js [port]');
  console.error('The first argument is a path to the file generated by lb-ng.');
  console.error('The second argument is a port number for the docs webserver.');
  return;
}

var services = path.resolve(process.argv[2]);
var port = process.argv[3] || 3030;

console.error('Using lb-ng file %j', services);

docular.genDocs({
  groups: [
    {
      groupTitle: 'LoopBack',
      groupId: 'loopback',
      sections: [
        {
          id: 'lbServices',
          title: 'LoopBack Services',
          scripts: [ path.resolve(services) ]
        }
      ]
    }
  ]
}, function() {
  docular.server({ port: port });
  console.log('Browse the documentation at http://localhost:%d/', port);
});
